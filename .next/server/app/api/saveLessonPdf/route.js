(()=>{var e={};e.id=7597,e.ids=[7597],e.modules={1708:e=>{"use strict";e.exports=require("node:process")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9801:e=>{"use strict";e.exports=import("firebase-admin/app")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{"use strict";e.exports=require("querystring")},11997:e=>{"use strict";e.exports=require("punycode")},12412:e=>{"use strict";e.exports=require("assert")},15694:(e,r,t)=>{"use strict";t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{POST:()=>c});var i=t(32190),o=t(9801),a=t(24803),u=t(25976),n=t(27910);!function(){var e=Error("Cannot find module '../../../serviceAccount.json'");throw e.code="MODULE_NOT_FOUND",e}();var p=e([o,a]);[o,a]=p.then?(await p)():p;let d=Object(function(){var e=Error("Cannot find module '../../../serviceAccount.json'");throw e.code="MODULE_NOT_FOUND",e}()),l=process.env.FIREBASE_STORAGE_BUCKET,x=process.env.GOOGLE_DRIVE_FOLDER_ID;if(!l)throw Error("Missing env: FIREBASE_STORAGE_BUCKET");if(!x)throw Error("Missing env: GOOGLE_DRIVE_FOLDER_ID");let f=(0,o.getApps)().length?(0,o.getApps)()[0]:(0,o.initializeApp)({credential:(0,o.cert)(d),storageBucket:l}),v=(0,a.getStorage)(f).bucket(),q=new u.q7g.auth.GoogleAuth({credentials:d,scopes:["https://www.googleapis.com/auth/drive.file"]}),g=u.q7g.drive({version:"v3",auth:q});async function c(e){try{let r=(await e.formData()).get("file");if(!(r instanceof Blob))throw Error("file フィールドが見つかりません");let t=await r.arrayBuffer(),s=Buffer.from(t),o=r instanceof File?r.name:`lessonPdf-${Date.now()}.pdf`;await v.file(`lessons/${o}`).save(s,{contentType:"application/pdf"});let a=n.Readable.from(s),u=(await g.files.create({requestBody:{name:o,mimeType:"application/pdf",parents:[x]},media:{mimeType:"application/pdf",body:a},fields:"id"})).data.id,p=`https://drive.google.com/file/d/${u}/view?usp=sharing`;return i.NextResponse.json({driveLink:p})}catch(e){return console.error("saveLessonPdf error:",e),i.NextResponse.json({error:e.message||"PDF保存に失敗しました"},{status:500})}}s()}catch(e){s(e)}})},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},24803:e=>{"use strict";e.exports=import("firebase-admin/storage")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},47700:(e,r,t)=>{"use strict";t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{patchFetch:()=>p,routeModule:()=>c,serverHooks:()=>x,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>l});var i=t(96559),o=t(48088),a=t(37719),u=t(15694),n=e([u]);u=(n.then?(await n)():n)[0];let c=new i.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/saveLessonPdf/route",pathname:"/api/saveLessonPdf",filename:"route",bundlePath:"app/api/saveLessonPdf/route"},resolvedPagePath:"C:\\Users\\yukia\\Downloads\\koku-lesson-planner\\app\\api\\saveLessonPdf\\route.ts",nextConfigOutput:"",userland:u}),{workAsyncStorage:d,workUnitAsyncStorage:l,serverHooks:x}=c;function p(){return(0,a.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:l})}s()}catch(e){s(e)}})},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},57975:e=>{"use strict";e.exports=require("node:util")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},78474:e=>{"use strict";e.exports=require("node:events")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},81630:e=>{"use strict";e.exports=require("http")},83997:e=>{"use strict";e.exports=require("tty")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[7719,580,3079,6300,7189,5976],()=>t(47700));module.exports=s})();